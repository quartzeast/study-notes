# 16. 进程管理与 SELinux 初探

## 1. 什么是进程

系统通过 UID/GID 和文件的属性来判定用户所执行指令的权限。系统会将加载进内存的程序运行为一个进程，并给予这个进程一个 ID，称为 PID，同时根据启动这个进程的用户与相关属性，给予这个 PID 一组有效的权限设置。

### 1.1 进程与程序（Process & Program）

- 「执行一个程序或指令」就可以触发一个事件以获取一个 PID
- 每个程序的文件拥有三组用户的权限（`u/g/o`），每组用户具有 `r/w/x` 的权限，所以，「不同的用户身份执行某个程序时，系统给予的权限也不同」。
- 程序存储在磁盘中，然后通过用户的执⾏来触发。触发后会载⼊到内存中成为⼀个进程。为了操作系统可管理这个进程，因此进程会分配执⾏者的权限/属性等参数，并包括进程的指令与数据或⽂件数据等，最后再给予⼀个 PID 。系统就是通过这个 PID 来判断该 process 是否具有权限进⾏⼯作的
- 程序（program）：通常为 binary program ，放置在储存媒体中 （如硬盘、光盘、软盘、磁带等）， 为实体⽂件的型态存在
- 进程（process）：程序被执行后，执⾏者的权限与属性、程序的指令与所需的数据等都会被加载进内存中，操作系统并给予这个内存内的单元⼀个识别码（PID），进程就是一个正在运⾏中的程序。

**子进程与父进程**

- 进程之间是相关的，某个进程的父进程通过 Parent PID（PPID）来识别
- 子进程可以获取父进程的环境变量

**fork 和 exec：进程的调用流程**

- 进程间的相互调用，Linux 的进程调⽤称为 fork-and-exec，⽗进程以 fork 的⽅式产⽣一个相同的临时进程，然后该临时进程再以 exec 的⽅式来执⾏实际要执行的程序，成为最终的子进程

**系统与网络服务：常驻内存的进程**

- 常驻内存的进程称为服务（daemon），可分为系统本身所需的服务如 crond, atd, rsyslogd 等，和负责网络连接的服务如 Apache, named, postfix,vsftpd 等

### 1.2 Linux 的多用户多任务环境

- Linux 下执行一个指令时，系统会将相关的权限、属性、机器指令和数据加载进内存，并分配给该进程一个 PID，最终该指令可进行的任务则与该 PID 的权限有关。
- 多用户、多任务
- Linux 中提供了六个文本登录界面和一个图形界面，可通过 Alt + F1 ~ F7 来切换不同的界面
- bash 环境的工作管理（job control）：`&`
- 多用户多任务的系统资源分配问题

## 2. 任务管理（Job Control）

### 2.1 什么是任务管理

- 进⾏⼯作管理的⾏为中，每个任务都是当前 bash 的⼦进程。我们⽆法以 job control 的⽅式由 tty1 的环境去管理 tty2 的 bash
- 在只有一个终端接口的情况下，可以出现提示字符进行操作的环境称为前台（foreground），其他的工作可以放入后台（backgroud）去暂停或执行。放入后台的工作在运行时不能与使用者进行交互。放⼊后台的⼯作是不可以使⽤ `[ctrl]+c` 来终⽌

### 2.2 Job Control 的管理

- 直接将指令在后台执行的 `&`

```bash
tar -zpcf /tmp/etc.tar.gz /etc &
[1] 14432
# job number 和 PID
```
